    {% extends 'base.html' %}
    {% load i18n %}
    {% block title %}{{ title }} | {% trans 'Sistema de gestión de aprendizaje' %}{% endblock title %}
    {% load crispy_forms_tags %}

    {% block content %}

    <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">{% trans 'Inicio' %}</a></li>
            <li class="breadcrumb-item"><a href="{% url 'programs' %}">{% trans 'Programas' %}</a></li>
            <li class="breadcrumb-item"><a href="{% url 'program_detail' course.program.id %}">{{ course.program }}</a></li>
            <li class="breadcrumb-item"><a href="{% url 'course_detail' course.slug %}">{{ course }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{% trans 'Subida de archivo' %}</li>
        </ol>
    </nav>
        
    <p class="title-1">{% trans 'Subida de archivo para' %} {{ course|truncatechars:25 }}</p>
    <br><br>

    {% include 'snippets/messages.html' %}

    <div class="row">
        <div class="col-md-8 p-0 mx-auto">
            <div class="card">
                <p class="form-title">{% trans 'Formulario de subida de archivo' %}</p>

                <div class="card-body">
                    <form action="" method="POST" enctype="multipart/form-data">{% csrf_token %}
                        <!-- Tipo de subida -->
                        <div class="form-group mb-4">
                            <label class="form-label fw-bold">Tipo de subida:</label>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="upload_type" id="upload_file" value="file" checked onchange="toggleUploadFields()">
                                        <label class="form-check-label" for="upload_file">
                                            <i class="fas fa-upload me-2"></i>Subir archivo desde mi PC
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="upload_type" id="upload_url" value="url" onchange="toggleUploadFields()">
                                        <label class="form-check-label" for="upload_url">
                                            <i class="fas fa-link me-2"></i>Usar enlace externo
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Título -->
                        <div class="form-group mb-3">
                            <label for="{{ form.title.id_for_label }}" class="form-label">Título del archivo:</label>
                            {{ form.title }}
                            {% if form.title.errors %}
                                <div class="text-danger">{{ form.title.errors }}</div>
                            {% endif %}
                        </div>

                        <!-- Campo de archivo -->
                        <div class="form-group mb-3" id="file-field">
                            <label for="{{ form.file.id_for_label }}" class="form-label">Seleccionar archivo:</label>
                            {{ form.file }}
                            {% if form.file.errors %}
                                <div class="text-danger">{{ form.file.errors }}</div>
                            {% endif %}
                            <div class="form-text">Formatos válidos: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, ZIP, RAR, 7ZIP</div>
                        </div>

                        <!-- Campo de URL -->
                        <div class="form-group mb-3" id="url-field" style="display: none;">
                            <label for="{{ form.external_url.id_for_label }}" class="form-label">URL externa:</label>
                            {{ form.external_url }}
                            {% if form.external_url.errors %}
                                <div class="text-danger">{{ form.external_url.errors }}</div>
                            {% endif %}
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Para Google Drive: usa el enlace de "Vista previa" o "Compartir"
                            </div>
                        </div>

                        <!-- Errores generales -->
                        {% if form.non_field_errors %}
                            <div class="alert alert-danger">
                                {{ form.non_field_errors }}
                            </div>
                        {% endif %}
                        
                        <div class="form-group">
                            <button class="btn btn-primary" type="submit">
                                <i class="fas fa-save me-2"></i>{% trans 'Subir' %}
                            </button>
                            <a class="btn btn-danger" href="{% url 'course_detail' course.slug %}" style="float: right;">
                                <i class="fas fa-times me-2"></i>{% trans 'Cancelar' %}
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
    function toggleUploadFields() {
        const fileRadio = document.getElementById('upload_file');
        const urlRadio = document.getElementById('upload_url');
        const fileField = document.getElementById('file-field');
        const urlField = document.getElementById('url-field');
        
        if (fileRadio.checked) {
            fileField.style.display = 'block';
            urlField.style.display = 'none';
            // Limpiar el campo de URL
            document.querySelector('input[name="external_url"]').value = '';
        } else if (urlRadio.checked) {
            fileField.style.display = 'none';
            urlField.style.display = 'block';
            // Limpiar el campo de archivo
            document.querySelector('input[name="file"]').value = '';
        }
    }
    
    // Inicializar al cargar la página
    document.addEventListener('DOMContentLoaded', function() {
        toggleUploadFields();
    });
    </script>

    {% endblock content %}