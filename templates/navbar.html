{% load i18n %}
<div id="top-navbar" class="py-1">
    <div class="container">
        <div class="nav-wrapper">

            <div class="toggle-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </div>

            <form class="form-header" action="{% url 'query' %}" method="GET">
                <input id="primary-search" class="form-control rounded-end-0" type="text" name="q" value="{{ request.GET.q }}"
                    placeholder="{% trans 'Buscar todo... #curso, #programa, #examen, #noticias, #eventos' %}" required />
                <button class="btn btn-dark rounded-start-0" type="submit">
                    <i class="fas fa-search"></i>
                </button>
            </form>

            <div class="dropdown">
                <div class="avatar border border-2" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="width:40px;height:40px;border-radius:50%;background:#007bff;color:white;display:flex;align-items:center;justify-content:center;font-weight:bold;">
                    {{ request.user.first_name|default:request.user.username|first|upper }}
                </div>
                <div class="dropdown-menu" style="min-width: 14rem !important;">
                    <div class="d-flex flex-column align-items-center">
                        <div class="avatar avatar-md border" style="width:40px;height:40px;border-radius:50%;background:#007bff;color:white;display:flex;align-items:center;justify-content:center;font-weight:bold;">
                            {{ request.user.first_name|default:request.user.username|first|upper }}
                        </div>
    
                        <p class="small text-muted text-center mb-0">
                            {% trans 'Último inicio de sesión:' %} {{ request.user.last_login|date }}</p>
                    </div>
                    <hr>

                    {% if request.user.is_lecturer or request.user.is_student %}
                    <a class="dropdown-item" href="{% url 'user_course_list' %}"><i class="fas fa-book me-2"></i>{% trans 'Mis cursos' %}</a>
                    {% endif %}

                    {% if request.user.is_superuser %}
                    <a class="dropdown-item" href="{% url 'admin_panel' %}"><i class="fas fa-user-tie me-2"></i>{% trans 'Panel de administración' %}</a>
                    {% endif %}

                    <a class="dropdown-item" href="{% url 'profile' %}"><i class="fas fa-user me-2"></i>{% trans 'Perfil' %}</a>
                    <a class="dropdown-item" href="{% url 'edit_profile' %}"><i class="fas fa-cog me-2"></i>{% trans 'Configuración' %}</a>
                    <hr>
                    <div style="display: flex; justify-content: center; align-items: center;">
                        <a class="btn btn-secondary" href="{% url 'logout' %}">
                            <i class="fas fa-sign-out-alt"></i> {% trans 'Cerrar sesión' %}
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>